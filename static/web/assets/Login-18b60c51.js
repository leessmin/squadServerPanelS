import{d as L,u as k,r as O,D as S,k as I,o as U,e as q,f as l,g as o,h as s,_ as F,x as V,c as n,q as v,i as B,s as E,v as N}from"./index-2df293b2.js";import{u as R}from"./useLoginStore-9aa4a7ba.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import"./http-9bd06147.js";import"./config-9c65774d.js";import"./formData-4b5941f0.js";const P=u=>(E("data-v-b3b621c0"),u=u(),N(),u),T={class:"login-section"},$=P(()=>l("h1",null,"登录面板",-1)),A={class:"verify-code-form"},j={class:"verify-code"},z=["src"],G=L({__name:"Login",setup(u){const m=k(),t=O({username:"",password:"",verifyCode:""}),g=async a=>{var d;let e=await r.Login(a.username,a.password,(d=p.value)==null?void 0:d.id,a.verifyCode);if(e==-1){r.getCaptcha();return}else e==0?(m.addRoute({path:"/init",name:"init",component:()=>F(()=>import("./Init-bfcfd7d0.js"),["./Init-bfcfd7d0.js","./useLoginStore-9aa4a7ba.js","./index-2df293b2.js","./index-ff9cab82.css","./http-9bd06147.js","./config-9c65774d.js","./formData-4b5941f0.js","./_plugin-vue_export-helper-c27b6911.js","./Init-705c4edb.css"],import.meta.url)}),m.push({name:"init"})):(V.success("登录成功"),m.push({name:"index"}))},b=a=>{console.log("Failed:",a)},y=S(()=>!(t.username&&t.password&&t.verifyCode)),r=R();r.$subscribe((a,e)=>{p.value=e.captcha}),r.getCaptcha();const p=I();return(a,e)=>{const d=n("UserOutlined"),_=n("a-input"),c=n("a-form-item"),h=n("LockOutlined"),C=n("a-input-password"),w=n("a-button"),x=n("a-form");return U(),q("main",null,[l("section",T,[$,o(x,{model:t,name:"normal_login",class:"login-form",onFinish:g,"label-col":{style:{width:"70px"}},onFinishFailed:b},{default:s(()=>[o(c,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名！！！"}]},{default:s(()=>[o(_,{value:t.username,"onUpdate:value":e[0]||(e[0]=i=>t.username=i)},{prefix:s(()=>[o(d,{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),o(c,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码！！！"}]},{default:s(()=>[o(C,{value:t.password,"onUpdate:value":e[1]||(e[1]=i=>t.password=i)},{prefix:s(()=>[o(h,{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),o(c,{label:"验证码",name:"verifyCode",rules:[{required:!0,message:"请输入验证码！！！"}]},{default:s(()=>{var i;return[l("div",A,[o(_,{value:t.verifyCode,"onUpdate:value":e[2]||(e[2]=f=>t.verifyCode=f)},null,8,["value"]),l("div",j,[l("img",{src:(i=p.value)==null?void 0:i.image,alt:"验证码好像消失了",title:"点击更换验证码",style:{cursor:"pointer"},onClick:e[3]||(e[3]=f=>v(r).getCaptcha())},null,8,z)])])]}),_:1}),o(c,null,{default:s(()=>[o(w,{disabled:v(y),type:"primary","html-type":"submit",class:"login-form-button"},{default:s(()=>[B(" 登录 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])])}}});const X=D(G,[["__scopeId","data-v-b3b621c0"]]);export{X as default};
