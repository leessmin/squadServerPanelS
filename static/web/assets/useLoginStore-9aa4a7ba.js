import{n as h,k as u,x as p,N as y}from"./index-2df293b2.js";import{h as n}from"./http-9bd06147.js";import{d as f}from"./formData-4b5941f0.js";const q=h("login",()=>{const s=u(),r=u("");async function l(){const a=await n().Require("/auth/captcha",{});(a==null?void 0:a.code)==200&&(s.value=a.data)}async function d(a,o,c,i){const e=f({username:a,password:o,captcha_id:c,captcha_code:i}),t=await n().Require("/auth/login",{method:"Post",body:e});return(t==null?void 0:t.code)!=200?-1:(r.value=t==null?void 0:t.data.token,localStorage.setItem("token",r.value),t.data.first?0:1)}async function m(a,o,c){const i=f({username:a,password:o,game_serve_path:c}),e=await n().Require("/BA/first/init",{method:"POST",body:i});(e==null?void 0:e.code)==200&&(console.log(e),localStorage.clear(),r.value="",p.success("初始化设置成功，请重新登录哦"),y.push({name:"login"}))}async function g(){let a=localStorage.getItem("token");const o=await n().Require("/auth/verify",{headers:{Authorization:`Bearer ${a}`}});(o==null?void 0:o.code)!=200&&(localStorage.clear(),location.reload())}return{captcha:s,getCaptcha:l,Login:d,initServer:m,verifyToken:g}});export{q as u};
